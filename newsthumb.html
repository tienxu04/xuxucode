<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News Thumbnail Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Roboto', sans-serif; background-color: #f3f4f6; }
        .serif { font-family: 'Merriweather', serif; }
        
        /* Container c·ªë ƒë·ªãnh t·ª∑ l·ªá 1200x630 nh∆∞ng scale nh·ªè l·∫°i ƒë·ªÉ v·ª´a m√†n h√¨nh xem tr∆∞·ªõc */
        .preview-wrapper {
            width: 100%;
            overflow: hidden;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            background: white;
            margin-bottom: 20px;
        }

        /* ƒê√¢y l√† khung h√¨nh g·ªëc s·∫Ω ƒë∆∞·ª£c xu·∫•t ra ·∫£nh */
        .design-canvas {
            width: 1200px;
            height: 630px;
            position: relative;
            background-color: #eee;
            overflow: hidden;
            /* Scale using CSS Transform for display purposes, but JS will capture full size */
            transform-origin: top left; 
        }

        /* Ti·ªán √≠ch ·∫©n hi·ªán */
        .hidden-input { display: none; }
    </style>
</head>
<body class="p-6">

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8">
        
        <div class="lg:col-span-4 space-y-6 bg-white p-6 rounded-xl shadow-lg h-fit sticky top-6">
            <h1 class="text-2xl font-bold text-gray-800 border-b pb-4">üõ† Editor</h1>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">1. Upload Image</label>
                <div class="flex items-center justify-center w-full">
                    <label for="imageInput" class="flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100">
                        <div class="flex flex-col items-center justify-center pt-5 pb-6">
                            <svg class="w-8 h-8 mb-4 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16">
                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"/>
                            </svg>
                            <p class="text-xs text-gray-500">Click to upload (JPG, PNG)</p>
                        </div>
                        <input id="imageInput" type="file" class="hidden-input" accept="image/*" />
                    </label>
                </div>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">2. Headline</label>
                <textarea id="headlineInput" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" placeholder="Nh·∫≠p ti√™u ƒë·ªÅ b√†i vi·∫øt t·∫°i ƒë√¢y...">Vietnam welcomes millions of international tourists in 2024</textarea>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">3. Short Description (Optional)</label>
                <textarea id="descInput" rows="2" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" placeholder="M√¥ t·∫£ ng·∫Øn...">The tourism sector has seen significant growth thanks to new visa policies.</textarea>
            </div>
            
            <div class="text-xs text-gray-500 italic mt-4">
                * Scroll xu·ªëng b√™n ph·∫£i ƒë·ªÉ xem c√°c m·∫´u v√† t·∫£i v·ªÅ.
            </div>
        </div>

        <div class="lg:col-span-8 space-y-10">
            
            <div>
                <div class="flex justify-between items-center mb-2">
                    <h3 class="text-lg font-bold text-gray-700">Style 1: Immersive Overlay</h3>
                    <button onclick="downloadImage('canvas1')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                        Download PNG
                    </button>
                </div>
                <div class="preview-wrapper" id="wrapper1">
                    <div id="canvas1" class="design-canvas relative">
                        <img id="imgPreview1" src="https://images.unsplash.com/photo-1502602898657-3e91760cbb34?q=80&w=2073&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover" alt="Background">
                        
                        <div class="absolute inset-0 bg-gradient-to-t from-black via-black/60 to-transparent"></div>

                        <div class="absolute bottom-0 left-0 w-full p-12">
                            <span class="inline-block bg-[#cc0000] text-white text-lg font-bold px-3 py-1 mb-4 uppercase tracking-wider rounded-sm">News</span>
                            <h1 id="textHeadline1" class="text-white text-5xl font-black leading-tight mb-4 drop-shadow-lg" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">
                                Vietnam welcomes millions of international tourists in 2024
                            </h1>
                            <p id="textDesc1" class="text-gray-200 text-2xl font-light max-w-4xl line-clamp-2">
                                The tourism sector has seen significant growth thanks to new visa policies.
                            </p>
                        </div>

                        <div class="absolute top-8 right-8 bg-white/90 backdrop-blur px-4 py-2 rounded-lg shadow-lg">
                            <img src="https://static-tuoitre.tuoitre.vn/tuoitrenews/images/logo-header.svg" class="h-8 w-auto">
                        </div>
                    </div>
                </div>
            </div>

            <div>
                <div class="flex justify-between items-center mb-2">
                    <h3 class="text-lg font-bold text-gray-700">Style 2: Split Magazine</h3>
                    <button onclick="downloadImage('canvas2')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                        Download PNG
                    </button>
                </div>
                <div class="preview-wrapper" id="wrapper2">
                    <div id="canvas2" class="design-canvas flex bg-white">
                        <div class="w-1/2 p-12 flex flex-col justify-center relative bg-slate-900">
                            <div class="absolute top-10 left-12 bg-white px-3 py-2 rounded">
                                <img src="https://static-tuoitre.tuoitre.vn/tuoitrenews/images/logo-header.svg" class="h-6 w-auto">
                            </div>
                            
                            <div class="mt-8">
                                <div class="w-16 h-2 bg-[#cc0000] mb-6"></div>
                                <h1 id="textHeadline2" class="text-white text-5xl font-bold leading-snug mb-6 serif">
                                    Vietnam welcomes millions of international tourists in 2024
                                </h1>
                                <p id="textDesc2" class="text-gray-400 text-xl font-normal leading-relaxed">
                                    The tourism sector has seen significant growth thanks to new visa policies.
                                </p>
                            </div>
                        </div>
                        
                        <div class="w-1/2 h-full relative">
                            <img id="imgPreview2" src="https://images.unsplash.com/photo-1502602898657-3e91760cbb34?q=80&w=2073&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover">
                             <div class="absolute left-0 top-0 bottom-0 w-2 bg-[#cc0000]"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div>
                <div class="flex justify-between items-center mb-2">
                    <h3 class="text-lg font-bold text-gray-700">Style 3: Breaking/Social Card</h3>
                    <button onclick="downloadImage('canvas3')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                        Download PNG
                    </button>
                </div>
                <div class="preview-wrapper" id="wrapper3">
                    <div id="canvas3" class="design-canvas relative flex flex-col">
                        <div class="h-[65%] w-full relative overflow-hidden">
                            <img id="imgPreview3" src="https://images.unsplash.com/photo-1502602898657-3e91760cbb34?q=80&w=2073&auto=format&fit=crop" class="w-full h-full object-cover">
                            <div class="absolute bottom-0 right-0 bg-[#cc0000] px-6 py-3 rounded-tl-xl">
                                <img src="https://static-tuoitre.tuoitre.vn/tuoitrenews/images/logo-header.svg" class="h-6 w-auto brightness-0 invert filter">
                            </div>
                        </div>

                        <div class="h-[35%] w-full bg-white p-8 border-t-4 border-[#cc0000] flex flex-col justify-center">
                            <h1 id="textHeadline3" class="text-gray-900 text-4xl font-black leading-tight line-clamp-2 uppercase">
                                Vietnam welcomes millions of international tourists in 2024
                            </h1>
                            <p id="textDesc3" class="text-gray-500 text-xl mt-2 line-clamp-1 truncate">
                                The tourism sector has seen significant growth thanks to new visa policies.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // 1. Elements Selection
        const imageInput = document.getElementById('imageInput');
        const headlineInput = document.getElementById('headlineInput');
        const descInput = document.getElementById('descInput');

        // Target Elements in 3 styles
        const previews = [
            { img: 'imgPreview1', title: 'textHeadline1', desc: 'textDesc1' },
            { img: 'imgPreview2', title: 'textHeadline2', desc: 'textDesc2' },
            { img: 'imgPreview3', title: 'textHeadline3', desc: 'textDesc3' }
        ];

        // 2. Handle Text Updates
        function updateText() {
            const headline = headlineInput.value || "Headline Example";
            const desc = descInput.value || "";

            previews.forEach(p => {
                document.getElementById(p.title).innerText = headline;
                // Handle optional description visibility
                const descEl = document.getElementById(p.desc);
                if(descEl) {
                    descEl.innerText = desc;
                    descEl.style.display = desc === "" ? 'none' : 'block';
                }
            });
        }

        headlineInput.addEventListener('input', updateText);
        descInput.addEventListener('input', updateText);

        // 3. Handle Image Upload
        imageInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    previews.forEach(p => {
                        document.getElementById(p.img).src = event.target.result;
                    });
                }
                reader.readAsDataURL(file);
            }
        });

        // 4. Handle Scale for Preview (Responsive Look)
        function resizePreviews() {
            const wrappers = document.querySelectorAll('.preview-wrapper');
            const baseWidth = 1200;
            
            wrappers.forEach(wrapper => {
                const containerWidth = wrapper.offsetWidth;
                const scale = containerWidth / baseWidth;
                const canvas = wrapper.querySelector('.design-canvas');
                
                // Set scale transform
                canvas.style.transform = `scale(${scale})`;
                // Adjust height of wrapper to match scaled height
                wrapper.style.height = `${630 * scale}px`;
            });
        }

        window.addEventListener('resize', resizePreviews);
        window.addEventListener('load', resizePreviews);
        // Call immediately just in case
        resizePreviews();


        // 5. Download Logic (High Resolution)
        function downloadImage(elementId) {
            const element = document.getElementById(elementId);
            
            // T·∫°m th·ªùi reset transform ƒë·ªÉ capture ƒë√∫ng k√≠ch th∆∞·ªõc g·ªëc
            const originalTransform = element.style.transform;
            element.style.transform = 'none';
            
            // html2canvas options
            html2canvas(element, {
                width: 1200,
                height: 630,
                scale: 1, // ƒê·∫£m b·∫£o ƒë√∫ng t·ªâ l·ªá pixel 1:1
                useCORS: true, // Cho ph√©p load ·∫£nh cross-origin (n·∫øu server ·∫£nh cho ph√©p)
                allowTaint: true,
                backgroundColor: null
            }).then(canvas => {
                // Restore transform for UI
                element.style.transform = originalTransform;

                // Create download link
                const link = document.createElement('a');
                const timestamp = new Date().getTime();
                link.download = `tuoitre-thumb-${timestamp}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            }).catch(err => {
                console.error("Error generating image:", err);
                alert("L·ªói khi t·∫°o ·∫£nh. H√£y th·ª≠ l·∫°i.");
                element.style.transform = originalTransform;
            });
        }
    </script>
</body>
</html>
